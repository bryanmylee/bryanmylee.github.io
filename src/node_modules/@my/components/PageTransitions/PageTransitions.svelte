<script lang="ts" context="module">
  import type { Readable } from 'svelte/store';
  export type IIsTransitioning = Readable<boolean>;
</script>

<script lang="ts">
  import { setContext } from 'svelte';
  import { writable, derived } from 'svelte/store';
  import { fade } from 'svelte/transition';

  export let refresh: any;
  export { tIn as in };
  let tIn = fade;
  export { tOut as out };
  let tOut = fade;
  export let transition = null;
  $: if (transition) {
    tIn = tOut = transition;
  }

  const isTransitioning = writable(false);
  setContext('isTransitioning', derived(isTransitioning, $i => $i));
</script>

<div id="page" class="relative">
  {#key refresh}
    <div
      in:tIn out:tOut
      on:introstart={() => $isTransitioning = true}
      on:outroend={() => $isTransitioning = false}
      class="absolute inset-0"
      >
      <slot/>
    </div>
  {/key}
</div>

<style>
  #page {
    height: calc(100vh - 6.25rem);
  }
</style>
