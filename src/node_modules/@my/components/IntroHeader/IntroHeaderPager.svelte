<script lang="ts">
  import { onMount } from 'svelte';
  import { usePrevious } from 'svelte-previous';
  import { backspaceAndType } from '@my/transitions/backspaceAndType';

  const interval = 4000;
  const speed = 50;

  export let values = [];
  $: maxIndex = values.length;
  const [currentValue, previousValue] = usePrevious('');
  let index = 0;
  $: $currentValue = values[index];
  $: totalLength = $currentValue?.length ?? 0 + $previousValue?.length ?? 0;
  const delayedUpdate = () => {
    const delay = speed * totalLength;
    setTimeout(() => {
      index = (index + 1) % maxIndex;
      delayedUpdate();
    }, interval + delay);
  };
  onMount(delayedUpdate);
</script>

<div class="relative">
  {#key $currentValue}
    <h2
      in:backspaceAndType={{from:$previousValue}}
      class="absolute font-bold w-max text-secondary"
      >
      {$currentValue}
    </h2>
  {/key}
</div>

