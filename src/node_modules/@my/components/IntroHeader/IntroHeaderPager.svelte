<script lang="ts">
  import { onMount } from 'svelte';
  import { usePrevious } from 'svelte-previous';
  import { backspaceAndType } from '@my/transitions/backspaceAndType';

  const interval = 3000;
  const duration = 500;

  export let values = [];
  $: maxIndex = values.length;
  const [currentValue, previousValue] = usePrevious('');
  let index = 0;
  $: $currentValue = values[index];
  onMount(() => {
    const timer = setInterval(() => {
      index = (index + 1) % maxIndex;
    }, interval);
    return () => clearInterval(timer);
  });
  $: totalLength = $currentValue?.length ?? 0 + $previousValue?.length ?? 0;
  $: speed = duration / totalLength;
</script>

<div class="relative">
  {#key $currentValue}
    <h2
      in:backspaceAndType={{from:$previousValue, speed}}
      class="absolute font-bold w-max text-secondary"
      >
      {$currentValue}
    </h2>
  {/key}
</div>

